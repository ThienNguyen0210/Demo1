<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Di·ªÖn ƒë√†n C·ªông ƒë·ªìng</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }
        .nav-link:hover {
            color: #f8f8f8;
            background-color: rgba(255, 255, 255, 0.1);
        }
        .thread-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .copy-btn:hover {
            background-color: #3a3a5e;
        }
        .mobile-menu {
            transition: all 0.3s ease;
            max-height: 0;
            overflow: hidden;
        }
        .mobile-menu.active {
            max-height: 1000px;
        }
        .cookie-banner {
            animation: slideUp 0.5s ease forwards;
        }
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
    </style>
</head>
<body style="    transform: scale(0.75);
    transform-origin: top left;
    width: 133.33%; /* ƒê·ªÉ kh√¥ng b·ªã thu h·∫πp n·ªôi dung */" class="bg-gray-900 text-gray-200 font-sans">
    <!-- Thanh tr√™n c√πng -->
    <div class="gradient-bg py-2 px-4 flex justify-between items-center" style="">
        <div class="flex space-x-4">
            <a target="_blank" href="/login" class="text-blue-400 hover:text-blue-300 text-sm font-medium" id="loggin" >ƒêƒÉng nh·∫≠p</a>
            <a target="_blank" href="/register" class="text-blue-400 hover:text-blue-300 text-sm font-medium" id="register" onclick="showForm('register')">ƒêƒÉng k√Ω</a>
        </div>
        <div class="hidden md:flex items-center space-x-4">
            <span class="text-sm">Tham gia c√πng <span class="font-bold text-yellow-300">33,000+</span> ng∆∞·ªùi ch∆°i tr·ª±c tuy·∫øn kh√°c!</span>
            <a class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm font-medium">Ch∆°i ngay</a>
        </div>
    </div>

    <!-- Ph·∫ßn ƒë·∫ßu trang -->
    <header class="gradient-bg py-4 px-6">
        <div class="container mx-auto flex flex-col md:flex-row items-center justify-between">
            <div class="flex items-center mb-4 md:mb-0">
                <a class="flex items-center">
                </a>
                <div class="ml-4 md:hidden">
                    <button id="mobile-menu-btn" class="text-white">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="hidden md:flex items-center space-x-1">
                <a href="/" class="nav-link px-4 py-2 rounded">Trang ch·ªß</a>
                <a class="nav-link px-4 py-2 rounded">N·∫°p Ti·ªÅn</a>
                    <a class="nav-link px-4 py-2 rounded flex items-center">
                        C·ªông ƒê·ªìng 
                    </a>
                <a class="nav-link px-4 py-2 rounded">Wiki</a>
                <div class="group relative">
                    <a class="nav-link px-4 py-2 rounded flex items-center">
                        Quy t·∫Øc <i class="fas fa-chevron-down ml-1 text-xs"></i>
                    </a>
                    <div class="absolute hidden group-hover:block bg-gray-800 rounded shadow-lg z-10 min-w-max">
                        <a class="block px-4 py-2 hover:bg-gray-700">Quy t·∫Øc m√°y ch·ªß</a>
                        <a class="block px-4 py-2 hover:bg-gray-700">Quy t·∫Øc tr√≤ ch∆°i</a>
                        <a class="block px-4 py-2 hover:bg-gray-700">Quy t·∫Øc di·ªÖn ƒë√†n</a>
                        <a class="block px-4 py-2 hover:bg-gray-700">ƒêi·ªÅu kho·∫£n d·ªãch v·ª•</a>
                        <a class="block px-4 py-2 hover:bg-gray-700">Ch√≠nh s√°ch b·∫£o m·∫≠t</a>
                    </div>
                </div>
                <a class="nav-link px-4 py-2 rounded">H·ªó tr·ª£</a>
                <a class="nav-link px-4 py-2 rounded">C·ª≠a h√†ng</a>
            </div>
            
            <div class="hidden md:flex items-center space-x-4">
                <a class="text-blue-400 hover:text-blue-300 flex items-center">
                    <i class="fas fa-bell mr-1"></i> C√≥ g√¨ m·ªõi
                </a>
                <a class="text-blue-400 hover:text-blue-300 flex items-center">
                    <i class="fas fa-search mr-1"></i> T√¨m ki·∫øm
                </a>
            </div>
        </div>
        
        <!-- Menu di ƒë·ªông -->
        <div id="mobile-menu" class="mobile-menu md:hidden bg-gray-800 mt-2 rounded-lg">
            <div class="px-4 py-2">
                <a class="block py-2 border-b border-gray-700">Trang ch·ªß</a>
                <a class="block py-2 border-b border-gray-700">Tr√≤ ch∆°i</a>
                <a class="block py-2 border-b border-gray-700">B·∫£ng x·∫øp h·∫°ng</a>
                <a class="block py-2 border-b border-gray-700">Di·ªÖn ƒë√†n</a>
                <a class="block py-2 border-b border-gray-700">Wiki</a>
                <a class="block py-2 border-b border-gray-700">Quy t·∫Øc</a>
                <a class="block py-2 border-b border-gray-700">H·ªó tr·ª£</a>
                <a class="block py-2">C·ª≠a h√†ng</a>
            </div>
        </div>
    </header>

    <!-- Ph·∫ßn IP m√°y ch·ªß -->
    <div class="bg-gray-800 py-4 px-6 text-center">
        <div class="container mx-auto flex flex-col md:flex-row items-center justify-center">
            <span class="text-lg mb-2 md:mb-0 md:mr-4">IP m√°y ch·ªß ¬ª MINEX.COM</span>
            <button id="copy-btn" class="copy-btn bg-gray-700 hover:bg-gray-600 text-white px-4 py-1 rounded flex items-center mx-auto md:mx-0">
                <i class="fas fa-copy mr-2"></i> Nh·∫•n ƒë·ªÉ sao ch√©p!
            </button>
        </div>
    </div>



<!-- Form ƒëƒÉng b√†i -->
<main class="max-w-2xl mx-auto py-10 space-y-6">

  <h1 class="text-3xl font-bold text-blue-400 text-center">üåê B·∫£ng tin c·ªông ƒë·ªìng</h1>

  <!-- Form ƒëƒÉng b√†i -->
  <form method="POST" action="/confession/post" enctype="multipart/form-data"
        class="bg-gray-800 p-4 rounded-xl shadow space-y-3">
    <textarea name="content" required placeholder="B·∫°n ƒëang nghƒ© g√¨?"
              class="w-full px-3 py-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
    <input type="file" name="image" accept="image/*"
           class="block text-sm text-gray-400">
    <button type="submit"
            class="bg-blue-600 px-4 py-2 rounded text-white hover:bg-blue-700 font-semibold">ƒêƒÉng b√†i</button>
  </form>

  <!-- Danh s√°ch b√†i vi·∫øt -->
  <div id="postList" class="space-y-4"></div>
<div class="mt-4">
  <form id="postForm" action="/confession/post" method="POST" enctype="multipart/form-data">
    <textarea id="confessionInput" name="content" class="w-full p-2 border rounded" placeholder="Chia s·∫ª ƒëi·ªÅu g√¨ ƒë√≥..."></textarea>
    <div class="flex justify-between mt-2">
      <input type="file" id="imageInput" name="image" accept="image/*" class="text-sm">
      <button type="submit" id="postButton" class="bg-blue-500 text-white px-4 py-2 rounded">ƒêƒÉng b√†i</button>
    </div>
  </form>
</div>
</main>

    <!-- N·ªôi dung ch√≠nh -->


    <!-- Ch√¢n trang -->
    <footer class="gradient-bg text-white py-8 px-4">
        <div class="container mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-lg font-bold mb-4">V·ªÅ ch√∫ng t√¥i</h3>
                    <p class="text-sm">Ch√∫ng t√¥i l√† m·ªôt m·∫°ng l∆∞·ªõi tr√≤ ch∆°i do c·ªông ƒë·ªìng ƒëi·ªÅu h√†nh, cung c·∫•p c√°c tr√≤ ch∆°i ƒë·ªôc ƒë√°o v√† n·ªôi dung ch·∫•t l∆∞·ª£ng cao cho ng∆∞·ªùi ch∆°i tr√™n to√†n th·∫ø gi·ªõi.</p>
                </div>
                <div>
                    <h3 class="text-lg font-bold mb-4">Li√™n k·∫øt h·ªØu √≠ch</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="/" class="hover:text-blue-400">Trang ch·ªß</a></li>
                        <li><a class="hover:text-blue-400">Quy t·∫Øc & Ch√≠nh s√°ch</a></li>
                        <li><a class="hover:text-blue-400">H·ªó tr·ª£</a></li>
                        <li><a class="hover:text-blue-400">Tr·∫°ng th√°i</a></li>
                        <li><a class="hover:text-blue-400">Vi·ªác l√†m</a></li>
                        <li><a class="hover:text-blue-400">ƒêi·ªÅu kho·∫£n d·ªãch v·ª•</a></li>
                        <li><a class="hover:text-blue-400">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-bold mb-4">Theo d√µi ch√∫ng t√¥i</h3>
                    <div class="flex items-center bg-gray-800 p-3 rounded-lg">
                        <img src="https://via.placeholder.com/48?text=Avatar" alt="C·ªông ƒë·ªìng" class="h-12 mr-3">
                        <div>
                            <a class="font-medium hover:text-blue-400">M·∫°ng C·ªông ƒë·ªìng</a>
                            <a class="block text-blue-400 hover:text-blue-300 text-sm mt-1">Theo d√µi ch√∫ng t√¥i</a>
                        </div>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-bold mb-4">C·ª≠a h√†ng</h3>
                    <p class="text-sm mb-4">H·ªó tr·ª£ ch√∫ng t√¥i b·∫±ng c√°ch mua h·∫°ng, ƒë√° qu√Ω v√† nhi·ªÅu th·ª© kh√°c ƒë·ªÉ gi√∫p ch√∫ng t√¥i t·∫°o ra n·ªôi dung ch·∫•t l∆∞·ª£ng cao h∆°n.</p>
                    <a class="bg-yellow-500 hover:bg-yellow-600 text-black font-medium py-2 px-4 rounded inline-block">Gh√© thƒÉm c·ª≠a h√†ng</a>
                </div>
            </div>
            
            <div class="flex flex-wrap justify-center gap-4 mt-8">
                <a class="text-red-500 hover:text-red-400 text-2xl"><i class="fab fa-youtube"></i></a>
                <a class="text-blue-400 hover:text-blue-300 text-2xl"><i class="fab fa-twitter"></i></a>
                <a class="text-black hover:text-gray-300 text-2xl"><i class="fab fa-tiktok"></i></a>
                <a class="text-pink-500 hover:text-pink-400 text-2xl"><i class="fab fa-instagram"></i></a>
                <a class="text-gray-300 hover:text-white text-2xl"><i class="fab fa-threads"></i></a>
                <a class="text-blue-300 hover:text-blue-200 text-2xl"><i class="fas fa-cloud"></i></a>
                <a class="text-blue-600 hover:text-blue-500 text-2xl" href="https://www.facebook.com/tnc0210?locale=vi_VN" target="_blank"><i class="fab fa-facebook"></i></a>
                <a class="text-indigo-400 hover:text-indigo-300 text-2xl"><i class="fab fa-discord"></i></a>
                <a class="text-green-400 hover:text-green-300 text-2xl"><i class="fas fa-question-circle"></i></a>
            </div>
            
            <div class="text-center mt-8 text-sm text-gray-400">
                ¬© 2025 M·∫°ng C·ªông ƒë·ªìng. M·ªçi quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.
            </div>
        </div>
    </footer>

    <!-- Banner cookie -->
    <div id="cookie-banner" class="cookie-banner fixed bottom-0 left-0 right-0 bg-gray-800 border-t border-gray-700 p-4 shadow-lg z-50">
        <div class="container mx-auto">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0 md:mr-4">
                    <h3 class="font-bold mb-2">Ch√∫ng t√¥i t√¥n tr·ªçng quy·ªÅn ri√™ng t∆∞ c·ªßa b·∫°n</h3>
                    <p class="text-sm">Ch√∫ng t√¥i s·ª≠ d·ª•ng <a class="text-blue-400 hover:text-blue-300">cookie c·∫ßn thi·∫øt</a> ƒë·ªÉ trang web n√†y ho·∫°t ƒë·ªông v√† cookie t√πy ch·ªçn ƒë·ªÉ n√¢ng cao tr·∫£i nghi·ªám c·ªßa b·∫°n.</p>
                    <a class="text-blue-400 hover:text-blue-300 text-sm">Xem th√™m th√¥ng tin v√† t√πy ch·ªânh t√πy ch·ªçn c·ªßa b·∫°n</a>
                </div>
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                    <button id="accept-cookies" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm">Ch·∫•p nh·∫≠n t·∫•t c·∫£ cookie</button>
                    <button id="reject-cookies" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm">T·ª´ ch·ªëi cookie t√πy ch·ªçn</button>
                </div>
            </div>
        </div>
    </div>

<script>
// ===== Mobile menu toggle with accessibility =====
const mobileMenuBtn = document.getElementById('mobile-menu-btn');
const mobileMenu = document.getElementById('mobile-menu');
mobileMenuBtn.setAttribute('aria-expanded', 'false');
mobileMenuBtn.setAttribute('aria-controls', 'mobile-menu');

mobileMenuBtn.addEventListener('click', () => {
    const isExpanded = mobileMenuBtn.getAttribute('aria-expanded') === 'true';
    mobileMenu.classList.toggle('active');
    mobileMenuBtn.setAttribute('aria-expanded', !isExpanded);
    mobileMenuBtn.querySelector('i').classList.toggle('fa-bars');
    mobileMenuBtn.querySelector('i').classList.toggle('fa-times');
});

// ===== Copy server IP with error handling =====
document.getElementById('copy-btn').addEventListener('click', async function () {
    try {
        await navigator.clipboard.writeText('MINEX.COM');
        const originalText = this.innerHTML;
        this.innerHTML = '<i class="fas fa-check mr-2"></i> Copied!';
        setTimeout(() => {
            this.innerHTML = originalText;
        }, 2000);
    } catch (err) {
        console.error('Failed to copy:', err);
        this.innerHTML = '<i class="fas fa-exclamation-triangle mr-2"></i> Copy Failed!';
        setTimeout(() => {
            this.innerHTML = '<i class="fas fa-copy mr-2"></i> Click to Copy!';
        }, 2000);
    }
});

// ===== Cookie banner with localStorage persistence =====
const cookieBanner = document.getElementById('cookie-banner');
const acceptCookies = document.getElementById('accept-cookies');
const rejectCookies = document.getElementById('reject-cookies');

if (localStorage.getItem('cookieConsent')) {
    cookieBanner.style.display = 'none';
}

acceptCookies.addEventListener('click', () => {
    localStorage.setItem('cookieConsent', 'accepted');
    cookieBanner.style.display = 'none';
});

rejectCookies.addEventListener('click', () => {
    localStorage.setItem('cookieConsent', 'rejected');
    cookieBanner.style.display = 'none';
});

// ===== Smooth scrolling for anchor links =====
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', (e) => {
        e.preventDefault();
        const target = document.querySelector(anchor.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// ===== Ph√¢n trang cho news =====
const pageInfo = document.querySelector('.pagination .page-info');
const pageInput = document.querySelector('.pagination .page-input');
const goButton = document.querySelector('.pagination .go-button');
const nextButton = document.querySelector('.pagination .next-button');
const lastButton = document.querySelector('.pagination .last-button');
const pageContainer = document.querySelector('.pagination .page-numbers');
const threads = document.querySelectorAll('.thread-card');

const itemsPerPage = 6;
let currentPage = 1;
let totalPages = Math.ceil(threads.length / itemsPerPage);

// C·∫≠p nh·∫≠t hi·ªÉn th·ªã c√°c b√†i vi·∫øt theo trang
function updateThreadsDisplay() {
    const startIndex = (currentPage - 1) * itemsPerPage;
    const endIndex = startIndex + itemsPerPage;
    threads.forEach((thread, index) => {
        thread.style.display = (index >= startIndex && index < endIndex) ? 'block' : 'none';
    });
}

// T·∫°o l·∫°i n√∫t ph√¢n trang
function renderPaginationButtons() {
    pageContainer.innerHTML = '';
    for (let i = 1; i <= totalPages; i++) {
        const btn = document.createElement('a');
        btn.textContent = i;
        btn.className = 'px-3 py-1 rounded cursor-pointer';
        if (i === currentPage) {
            btn.classList.add('bg-blue-600', 'text-white');
        } else {
            btn.classList.add('bg-gray-700', 'hover:bg-gray-600', 'text-white');
        }
        btn.addEventListener('click', () => {
            currentPage = i;
            updatePageDisplay();
        });
        pageContainer.appendChild(btn);
    }
}

// C·∫≠p nh·∫≠t trang hi·ªán t·∫°i + n√∫t + b√†i vi·∫øt
function updatePageDisplay() {
    pageInfo.textContent = `${currentPage} of ${totalPages}`;
    renderPaginationButtons();
    updateThreadsDisplay();
}

// C√°c n√∫t ƒëi·ªÅu h∆∞·ªõng
nextButton.addEventListener('click', () => {
    if (currentPage < totalPages) {
        currentPage++; // TƒÉng trang
        updatePageDisplay();
    }
});

lastButton.addEventListener('click', () => {
    if (currentPage > 1) {
        currentPage--; // Gi·∫£m trang
        updatePageDisplay();
    }
});


goButton.addEventListener('click', () => {
    const inputPage = parseInt(pageInput.value);
    if (inputPage >= 1 && inputPage <= totalPages) {
        currentPage = inputPage;
        updatePageDisplay();
    } else {
        alert(`Vui l√≤ng nh·∫≠p s·ªë trang t·ª´ 1 ƒë·∫øn ${totalPages}`);
        pageInput.value = currentPage;
    }
});

pageInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') goButton.click();
});

// ===== Kh·ªüi t·∫°o =====
updatePageDisplay();








  async function fetchPosts() {
    const res = await fetch('/confession/posts');
    const posts = await res.json();
    const container = document.getElementById('postList');
    container.innerHTML = '';

    posts.forEach(post => {
      const comments = post.comments.map(c => `
        <p class="ml-4 text-sm text-gray-300">üí¨ <b>${c.username}</b>: ${c.content}</p>
      `).join('');

      container.innerHTML += `
        <div class="bg-gray-800 rounded-xl p-4 shadow space-y-2">
          <p class="text-sm text-gray-400">üë§ ${post.username} ‚Ä¢ ${new Date(post.created_at).toLocaleString()}</p>
          <p>${post.content}</p>
          ${post.image ? `<img src="/uploads/${post.image}" class="rounded max-h-64">` : ''}

          <form method="POST" action="/confession/comment" class="flex gap-2 mt-2">
            <input type="hidden" name="post_id" value="${post.id}">
            <input name="comment" placeholder="Vi·∫øt b√¨nh lu·∫≠n..." class="flex-1 px-3 py-1 rounded bg-gray-700 text-white text-sm">
            <button class="text-sm bg-blue-600 px-2 py-1 rounded text-white">G·ª≠i</button>
          </form>

          <form method="POST" action="/confession/like" class="mt-1">
            <input type="hidden" name="post_id" value="${post.id}">
            <button class="text-sm text-green-400 hover:underline">üëç Th√≠ch (${post.likes})</button>
          </form>

          ${comments}
        </div>`;
    });
  }

  fetchPosts();







  document.getElementById('postForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const content = document.getElementById('confessionInput').value;
    const image = document.getElementById('imageInput').files[0];
    const formData = new FormData();
    formData.append('content', content);
    if (image) formData.append('image', image);

    try {
      const response = await fetch('/confession/post', {
        method: 'POST',
        body: formData
      });
      if (response.ok) {
        window.location.reload(); // T·∫£i l·∫°i trang sau khi ƒëƒÉng b√†i
      } else {
        alert('L·ªói khi ƒëƒÉng b√†i');
      }
    } catch (error) {
      console.error('L·ªói:', error);
      alert('L·ªói khi g·ª≠i b√†i');
    }
  });
</script>
</body>
</html>